version: 2
jobs:
  build:
    docker:
      - image: python:latest
    steps:
      - checkout
      - restore_cache:
          key: vint-application
      - run:
          name: Install Vint
          command: pip install --upgrade --user vim-vint
      - run:
          name: Create package list (for caching)
          command: pip freeze --user > ./requirement.txt
      - save_cache:
          paths:
            - ~/.local
          key: vint-application-{{ checksum "./requirement.txt" }}
      - run:
          name: OS release
          command: cat /etc/debian_version
      - run:
          name: Kernel version
          command: uname -a
      - run:
          name: Python version
          command: python --version
      - run:
          name: Vint version
          command: ~/.local/bin/vint --version
      - run:
          name: Run Vint (vimrc)
          command: ~/.local/bin/vint --color --style-problem -- ./vimrc
      - run:
          name: Run Vint (gvimrc)
          command: ~/.local/bin/vint --color --style-problem -- ./gvimrc
